{% extends 'base.html.twig' %}

{% block title %} {% if user %} Modifier {% else %}  Ajouter {% endif %}un utilisateur {% endblock %}

{% block stylesheets %}

{% endblock %}

        {% block content %}
            <div class="container-fluid add-form-list">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between">
                                <div class="header-title">
                                    <h4 class="card-title">{% if user %} Modifier {% else %}  Ajouter {% endif %}
                                        un utilisateur</h4>
                                </div>
                            </div>
                            <div class="card-body">
                                {% if not form.vars.valid %}
                                    <div class="alert alert-danger" role="alert">
                                        {# on affiche en premier les erreurs globales (cas classiques) #}
                                        {% for error in form.vars.errors %}
                                            <li>{{ error.message }}</li>
                                        {% endfor %}
                                        {# ainsi que les erreurs concernant chaque champs #}
                                        {% for child in form.children %}
                                            {# si le champ à des erreur #}
                                            {% if child.vars.errors is defined %}
                                                {% for error in child.vars.errors %}
                                                    <p>{{ error.message }} </p> {# on ajoute le label du champ devant l'erreur pour plus de précisions. #}
                                                {% endfor %}
                                            {% endif %}
                                        {% endfor %}
                                    </div>
                                {% endif %}

                                {{ form_start(form,{'method': 'post', 'action': path('edit_user' , {id: user.id}),'attr': {'class': 'needs-validation' , 'novalidate' : 'novalidate' , 'id' : 'formEditUser' }}) }}
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label>Matricule *</label>
                                            {{ form_widget(form.matricule ,{'attr': {'class' : 'form-control' , 'placeholder': 'Enter le  matricule'}}) }}
                                            <div class="invalid-feedback">
                                                s'il vous plaît entre le Matricule
                                            </div>
                                            <div class="help-block with-errors"></div>
                                        </div>
                                    </div>
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label>Nom *</label>
                                            {{ form_widget(form.lastName , {'attr': {'class' : 'form-control' , 'placeholder': 'Entre le nom'}}) }}
                                            <div class="invalid-feedback">
                                                s'il vous plaît entre le nom
                                            </div>
                                            <div class="help-block with-errors"></div>
                                        </div>
                                    </div>
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label>Prénom *</label>
                                            {{ form_widget(form.firstName , {'attr': {'class' : 'form-control' , 'placeholder': 'Entre le prénom'}}) }}
                                            <div class="invalid-feedback">
                                                s'il vous plaît entre le nom
                                            </div>
                                            <div class="help-block with-errors"></div>
                                        </div>
                                    </div>
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label>Téléphone * (8 chiffres)</label>
                                            {{ form_widget(form.phone , {'attr': {'class' : 'form-control' , 'placeholder': '99999999'}}) }}
                                            <div class="invalid-feedback">
                                                s'il vous plaît entre le nom
                                            </div>
                                            <div class="help-block with-errors"></div>
                                        </div>
                                        <div class="form-group">
                                            <label>Fonction *</label>
                                            {{ form_widget(form.function , {'attr': {'class' : 'form-control' , 'placeholder': 'Entre la fontion'}}) }}
                                            <div class="help-block with-errors"></div>
                                            <div class="invalid-feedback">
                                                s'il vous plaît entre le prénom
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label>Email *</label>
                                            {{ form_widget(form.email , {'attr': {'class' : 'form-control' , 'placeholder': 'Enter email valid'}}) }}
                                            <div class="invalid-feedback">
                                                s'il vous plaît entre un email valide
                                            </div>
                                            <div class="help-block with-errors"></div>
                                        </div>
                                    </div>
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label>Département *</label>
                                            <select name="departement" class="form-control">
                                                <option value="" disabled >Coisir un département</option>
                                                {%  for d in departements %}
                                                    <option value="{{ d.id }}" {%  if user.departemnt.id  == d.id %} selected {% endif %}>{{ d.libelle }}</option>
                                                {% endfor %}
                                            </select>
                                            <div class="help-block with-errors"></div>
                                        </div>


                                    </div>
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label>Role *</label>
                                            <select name="roles" class="form-control">
                                                <option value="" disabled selected>Coisir un role</option>

                                                <option value="ROLE_ADMIN" {% if user.roles[0] == 'ROLE_ADMIN' %} selected {% endif %}>
                                                    Administrateur
                                                </option>
                                                <option value="ROLE_RESPONSABLE" {% if user.roles[0] == 'ROLE_RESPONSABLE' %} selected {% endif %}>
                                                    Responsable
                                                </option>
                                                <option value="ROLE_GERANT" {% if user.roles[0] == 'ROLE_GERANT' %} selected {% endif %} >
                                                    Gérant
                                                </option>
                                            </select>
                                            <div class="help-block with-errors"></div>
                                        </div>


                                    </div>

                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label>Password *</label>
                                            <input type="password" name="password" class="form-control">
                                        </div>


                                    </div>
                                </div>

                                <button type="submit"
                                        class="btn btn-primary mr-2">{% if user %} Modifier {% else %}  Sauvargarder {% endif %}</button>
                                <button type="reset" class="btn btn-danger">Annuler</button>

                                {{ form_end(form) }}


                            </div>
                        </div>
                    </div>
                </div>
                <!-- Page end  -->
            </div>
        {% endblock %}


{% block javascripts %}

{% endblock %}